version: '2.1'

services:
  build:
    build:
      context: ..
      dockerfile: docker/Dockerfile
    image: usps
    entrypoint:
      - bash
      - -c
      - dep ensure && go build cmd/usps-util.go && ./usps-util 820NA0004722 9410810298370122910773
    volumes:
      - ..:/go/src/usps/

  test:
    extends:
      service: build
    entrypoint: go test
